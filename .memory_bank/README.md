# Memory Bank - Система "Живая Документация"

## Что это такое?

Memory Bank - это система документации, которая служит внешней памятью для ИИ-агентов. Она решает проблему потери контекста между сессиями и обеспечивает непрерывность разработки проекта Fiction Library.

## Структура файлов

```
.memory_bank/
├── projectbrief.md          # Цели и границы проекта (редко изменяется)
├── productContext.md        # Пользовательские истории и бизнес-контекст
├── systemPatterns.md        # Архитектурные паттерны (КРИТИЧНО для кода)
├── techContext.md           # Технологический стек и ограничения
├── activeContext.md         # Текущие задачи и планы (часто обновляется)
├── progress.md              # Статус задач и Git-синхронизация
├── ai-agent-instructions.md # Инструкции для всех ИИ-агентов
└── README.md               # Этот файл
```

## Быстрый старт для ИИ-агентов

### 1. Обязательное чтение в начале сессии
```bash
# Прочитать эти файлы ПЕРВЫМИ:
cat .memory_bank/activeContext.md    # Что сейчас в работе?
cat .memory_bank/progress.md         # Какой статус проекта?
cat .memory_bank/systemPatterns.md   # Какие паттерны использовать?
```

### 2. Проверка Git-синхронизации
```bash
# Получить текущий хеш коммита
git log -1 --format="%H"

# Сравнить с хешем из progress.md
# Если различаются - обновить Memory Bank
```

### 3. Планирование работы
- Обновить `activeContext.md` с планом задачи
- Проверить соответствие `projectbrief.md`
- Выбрать паттерны из `systemPatterns.md`

### 4. Завершение работы
- Обновить `progress.md` со статусом
- Очистить детали из `activeContext.md`
- Обновить Git-хеш

## Конфигурация для разных ИИ-инструментов

### Cline / Roo Code
Файл `.clinerules` уже настроен. Система будет работать автоматически.

### Cursor
Файл `.cursorrules` уже настроен. Используйте с Composer и Chat.

### Другие агенты
Читайте `ai-agent-instructions.md` для универсальных инструкций.

## Ключевые принципы

### ✅ ВСЕГДА
- Читать Memory Bank в начале сессии
- Обновлять `activeContext.md` перед кодом
- Следовать паттернам из `systemPatterns.md`
- Проверять Git-синхронизацию
- Обновлять документацию при изменениях

### ❌ НИКОГДА
- Не писать код без чтения Memory Bank
- Не использовать технологии не из `techContext.md`
- Не противоречить `projectbrief.md`
- Не игнорировать архитектурные паттерны
- Не оставлять документацию неактуальной

## Специфика проекта Fiction Library

### Критические компоненты
- **Telegram API**: Сложная интеграция, требует Factory Pattern
- **Асинхронные очереди**: Используйте Queue Pattern
- **База данных**: Только Supabase с Repository Pattern
- **Файлы**: Cloud.ru S3 для хранения

### Технологические ограничения
- Next.js 15.5.9 + React 19 + TypeScript (строгий режим)
- shadcn/ui + Tailwind CSS 4.0 для UI
- Supabase для данных и аутентификации
- pnpm для управления пакетами

## Полезные команды

### Разработка
```bash
pnpm dev                    # Запуск dev сервера
pnpm build                  # Сборка проекта
pnpm lint                   # Проверка кода
```

### Telegram синхронизация
```bash
pnpm book-worm             # Основная синхронизация
pnpm book-worm:scheduled   # По расписанию
```

### Система очередей
```bash
pnpm worker                # Обработчик очередей
pnpm check-download-queue  # Статус очередей
```

## Troubleshooting

### Memory Bank не синхронизирован
1. Проверить Git-хеш в `progress.md`
2. Выполнить `git diff [старый_хеш] HEAD`
3. Обновить соответствующие файлы

### Код не соответствует паттернам
1. Изучить `systemPatterns.md`
2. Рефакторить согласно паттернам
3. Обновить паттерны при необходимости

### Неизвестные технологии
1. Проверить `techContext.md`
2. Добавить с обоснованием или заменить

## Метрики успеха

- **Время загрузки контекста**: < 30 секунд
- **Соответствие паттернам**: 100%
- **Актуальность документации**: Синхронизация с каждым коммитом
- **Качество кода**: TypeScript strict mode без ошибок

---

**Помните**: Memory Bank - это не просто документация, это внешняя память ИИ-агента. Поддерживайте её в актуальном состоянии для эффективной работы!