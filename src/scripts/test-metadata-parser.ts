import { MetadataParser } from '../lib/telegram/parser';
import dotenv from 'dotenv';

// –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
dotenv.config();

// –¢–µ—Å—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è Telegram
const testMessage = `
–ê–≤—Ç–æ—Ä: –°–µ—Ä–≥–µ–π –¢–∫–∞—á–µ–≤
–ù–∞–∑–≤–∞–Ω–∏–µ: —Ü–∏–∫–ª –î—Ä–∏–º–µ—Ä—ã
–ñ–∞–Ω—Ä: #—Ñ—ç–Ω—Ç–µ–∑–∏, #–ø—Ä–∏–∫–ª—é—á–µ–Ω—á–µ—Å–∫–æ–µ, #–º–∞–≥–∏—è
–†–µ–π—Ç–∏–Ω–≥: 4.5
–í –º–∏—Ä–µ, –≥–¥–µ –º–∞–≥–∏—è –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –ø–µ—Ä–µ–ø–ª–µ–ª–∏—Å—å –≤–æ–µ–¥–∏–Ω–æ, –Ω–∞—á–∏–Ω–∞—é—â–∏–π –º–∞–≥ –î—Ä–∏–º–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –æ–ø–∞—Å–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ, —á—Ç–æ–±—ã —Ä–∞—Å–∫—Ä—ã—Ç—å —Ç–∞–π–Ω—ã –¥—Ä–µ–≤–Ω–µ–≥–æ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞. –ï–≥–æ –ø—É—Ç—å –±—É–¥–µ—Ç –ø–æ–ª–æ–Ω –∏—Å–ø—ã—Ç–∞–Ω–∏–π, –±–∏—Ç–≤ —Å —á—É–¥–æ–≤–∏—â–∞–º–∏ –∏ –æ—Ç–∫—Ä—ã—Ç–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –∏–∑–º–µ–Ω—è—Ç —Å–∞–º—É —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å.

–°–æ—Å—Ç–∞–≤:
1. –ö–Ω–∏–≥–∞ –ü–µ—Ä–≤–∞—è (2020)
2. –ö–Ω–∏–≥–∞ –í—Ç–æ—Ä–∞—è (2021)
3. –ö–Ω–∏–≥–∞ –¢—Ä–µ—Ç—å—è (2022)
`;

console.log('üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö');
console.log('–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:');
console.log(testMessage);
console.log('\n--- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ ---');

const metadata = MetadataParser.parseMessage(testMessage);

console.log(`–ê–≤—Ç–æ—Ä: ${metadata.author}`);
console.log(`–ù–∞–∑–≤–∞–Ω–∏–µ: ${metadata.title}`);
console.log(`–°–µ—Ä–∏—è: ${metadata.series || '–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}`);
console.log(`–ñ–∞–Ω—Ä—ã: ${metadata.genres.join(', ')}`);
console.log(`–¢–µ–≥–∏: ${metadata.tags.join(', ')}`);
console.log(`–†–µ–π—Ç–∏–Ω–≥: ${metadata.rating}`);
console.log(`–û–ø–∏—Å–∞–Ω–∏–µ: ${metadata.description}`);
console.log(`–ö–Ω–∏–≥–∏ –≤ —Å–µ—Ä–∏–∏: ${metadata.books.length}`);

for (const book of metadata.books) {
  console.log(`  - ${book.title} (${book.year})`);
}