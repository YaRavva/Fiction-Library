import { MetadataParser } from '../lib/telegram/parser';

async function debugTelegramMessage() {
  try {
    console.log('üîç –û—Ç–ª–∞–¥–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è Telegram');
    
    // –†–µ–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ Telegram
    const telegramMessage = `–ê–≤—Ç–æ—Ä: –ï–ª–∏–∑–∞–≤–µ—Ç–∞ –î–≤–æ—Ä–µ—Ü–∫–∞—è
–ù–∞–∑–≤–∞–Ω–∏–µ: —Ü–∏–∫–ª –ö–æ—Ä–∞–±–ª—å –≤–æ —Ñ—å–æ—Ä–¥–µ
–ñ–∞–Ω—Ä: #—Ñ—ç–Ω—Ç–µ–∑–∏ #–ø—Ä–∏–∫–ª—é—á–µ–Ω—á–µ—Å–∫–æ–µ #—Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ—Ñ—ç–Ω—Ç–µ–∑–∏ #–º–æ—Ä—Å–∫–∏–µ—Ñ—ç–Ω—Ç–µ–∑–∏ #–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è–∏—Å—Ç–æ—Ä–∏—è #–∑–∞–∫–æ–Ω—á–µ–Ω
–†–µ–π—Ç–∏–Ω–≥: 7.51 #–≤—ã—à–µ7
–ö–æ–≥–¥–∞ –≤–∏–∫–∏–Ω–≥–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –∑–∞ —Ç–æ–±–æ–π ‚Äî –Ω–µ —Å—Ç–æ–∏—Ç —Å–¥–∞–≤–∞—Ç—å—Å—è –±–µ–∑ –±–æ—è. –¢–µ–º –±–æ–ª–µ–µ, –µ—Å–ª–∏ —Ç—ã —É–º–µ–µ—à—å —É–ø—Ä–∞–≤–ª—è—Ç—å –æ–≥–Ω—ë–º, –∏ —É —Ç–µ–±—è –µ—Å—Ç—å —Ç–∞–π–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—É—é –ª—É—á—à–µ —Å–∫—Ä—ã–≤–∞—Ç—å. –ù–æ –∏ –≤ –±–µ–≥–∞ –º–æ–∂–Ω–æ —É–π—Ç–∏, –µ—Å–ª–∏ –ø–æ–≤–µ–∑—ë—Ç. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –Ω–µ —É—Ç–æ–Ω—É—Ç—å –≤ –º–æ—Ä–µ, –Ω–µ —Å–≥–æ—Ä–µ—Ç—å –≤ –ø–ª–∞–º–µ–Ω–∏ –∏ –Ω–µ –≤–ª—é–±–∏—Ç—å—Å—è –≤ —á–µ–ª–æ–≤–µ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –ø—Ä–∏—á–∏–Ω–æ–π —Ç–≤–æ–µ–π –≥–∏–±–µ–ª–∏. –ò–ª–∏ —Å–ø–∞—Å—Ç–∏ —Ç–µ–±—è –æ—Ç –Ω–µ—ë.
–°–æ—Å—Ç–∞–≤:
–ö–æ—Ä–∞–±–ª—å –≤–æ —Ñ—å–æ—Ä–¥–µ (2018)
–ü–ª–∞–º—è –∏ –≤–æ–¥–∞ (2019)
–ü–µ–ø–µ–ª –∏ –ª—ë–¥ (2020)
–í–æ–ª–Ω–∞ –∏ –ø—Ä–∏–ª–∏–≤ (2021)`;

    console.log('üìù –°–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ Telegram:');
    console.log(telegramMessage);
    
    // –ü–∞—Ä—Å–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    const metadata = MetadataParser.parseMessage(telegramMessage);
    
    console.log('\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞:');
    console.log('- –ê–≤—Ç–æ—Ä:', metadata.author);
    console.log('- –ù–∞–∑–≤–∞–Ω–∏–µ:', metadata.title);
    console.log('- –ñ–∞–Ω—Ä—ã:', metadata.genres.join(', '));
    console.log('- –¢–µ–≥–∏:', metadata.tags.join(', '));
    console.log('- –†–µ–π—Ç–∏–Ω–≥:', metadata.rating);
    console.log('- –û–ø–∏—Å–∞–Ω–∏–µ:', metadata.description);
    console.log('- –ö–Ω–∏–≥–∏ –≤ —Å–æ—Å—Ç–∞–≤–µ:', metadata.books.length);
    
    if (metadata.books.length > 0) {
      console.log('\nüìö –ö–Ω–∏–≥–∏ –≤ —Å–æ—Å—Ç–∞–≤–µ:');
      metadata.books.forEach((book, index) => {
        console.log(`  ${index + 1}. ${book.title} (${book.year})`);
      });
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–ª–æ–≤–æ "–°–æ—Å—Ç–∞–≤:" –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏
    if (telegramMessage.includes('–°–æ—Å—Ç–∞–≤:')) {
      console.log('\n‚úÖ –í —Å–æ–æ–±—â–µ–Ω–∏–∏ –µ—Å—Ç—å —Å–ª–æ–≤–æ "–°–æ—Å—Ç–∞–≤:", —Å–µ—Ä–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–∞');
    } else {
      console.log('\n‚ùå –í —Å–æ–æ–±—â–µ–Ω–∏–∏ –Ω–µ—Ç —Å–ª–æ–≤–∞ "–°–æ—Å—Ç–∞–≤:"');
    }
    
    console.log('\n‚úÖ –û—Ç–ª–∞–¥–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ:', error);
  }
}

// –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Ç–ª–∞–¥–∫—É
debugTelegramMessage();