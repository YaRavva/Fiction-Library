import { MetadataParser } from '../lib/telegram/parser';
import dotenv from 'dotenv';

// –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
dotenv.config();

// –¢–µ—Å—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è Telegram —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏
const testMessage = `–ê–≤—Ç–æ—Ä: –û–ª—å–≥–∞ –ë–æ–ª–¥—ã—Ä–µ–≤–∞

–ù–∞–∑–≤–∞–Ω–∏–µ: —Ü–∏–∫–ª –ü–æ—Å–æ–±–∏–µ –¥–ª—è –¢—ë–º–Ω–æ–≥–æ –∫–Ω—è–∑—è

–ñ–∞–Ω—Ä: 
#—Ñ—ç–Ω—Ç–µ–∑–∏
#–≥–µ—Ä–æ–∏—á–µ—Å–∫–æ–µ—Ñ—ç–Ω—Ç–µ–∑–∏
#–ø—Ä–∏–∫–ª—é—á–µ–Ω—á–µ—Å–∫–æ–µ
#–∑–∞–∫–æ–Ω—á–µ–Ω

–†–µ–π—Ç–∏–Ω–≥: 7.05 #–≤—ã—à–µ7

–ï—Å–ª–∏ –¢–µ–º–Ω—ã–π –í–ª–∞—Å—Ç–µ–ª–∏–Ω —Å—Ç—Ä–∞–¥–∞–µ—Ç —Å–∫—É–∫–æ–π ‚Äî –ø–ª–æ—Ö–æ –≤—Å–µ–º –≤–æ–∫—Ä—É–≥. –û–¥–Ω–∞–∫–æ –≤–æ–∑—å–º–µ–º –æ–¥–Ω—É –∫–æ–º–∞–Ω–¥—É –≥–µ—Ä–æ–µ–≤, –∏–¥—É—â–∏—Ö –ø–æ –µ–≥–æ –≥–æ–ª–æ–≤—É ‚Äî –∏ –≤–æ—Ç —É–∂–µ —Ç–µ–±–µ –∏ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è, –∏ –≤—Ä–∞–≥–∏, –∏ –¥–∞–∂–µ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç–∏—è. –ù–∞—Å—Ç–æ–ª—å–∫–æ, —á—Ç–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø–µ—Ä–µ—Å—Ç–∞—Ç—å –∏–≥—Ä–∞—Ç—å—Å—è —Å ¬´–Ω–æ–≤—ã–º–∏ –∏–≥—Ä—É—à–∫–∞–º–∏¬ª, –∏ —Å–µ—Ä—å–µ–∑–Ω–æ –≤–∑—è—Ç—å—Å—è –∑–∞ –±–µ—Å–ø–æ—Ä—è–¥–∫–∏, —Ç–≤–æ—Ä—è—â–∏–µ—Å—è –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–µ–º–ª—è—Ö. –¢—É—Ç –≥–ª–∞–≤–Ω–æ–µ –Ω–µ –ø–µ—Ä–µ—Å—Ç–∞—Ä–∞—Ç—å—Å—è. –í–µ–¥—å —Ü–µ–Ω–∞ –æ—à–∏–±–∫–∏ ‚Äî –∂–∏–∑–Ω–∏ –¥–æ—Ä–æ–≥–∏—Ö —Ç–µ–±–µ —Å—É—â–µ—Å—Ç–≤.

–°–æ—Å—Ç–∞–≤:
–ö–∞–∫ —Ä–∞–∑–≤–µ—è—Ç—å —Å–∫—É–∫—É (2010)
–ö–∞–∫ —Ä–∞–∑–¥–∞—Ç—å –¥–æ–ª–≥–∏ (2013)`;

console.log('üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö');
console.log('–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:');
console.log(testMessage);
console.log('\n--- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ (–¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è) ---');

const metadata = MetadataParser.parseMessage(testMessage);

console.log(`–ê–≤—Ç–æ—Ä: "${metadata.author}"`);
console.log(`–ù–∞–∑–≤–∞–Ω–∏–µ: "${metadata.title}"`);
console.log(`–°–µ—Ä–∏—è: ${metadata.series || '–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}`);
console.log(`–†–µ–π—Ç–∏–Ω–≥: ${metadata.rating}`);
console.log(`–ñ–∞–Ω—Ä—ã: [${metadata.genres.map(g => `"${g}"`).join(', ')}]`);
console.log(`–¢–µ–≥–∏: [${metadata.tags.map(t => `"${t}"`).join(', ')}]`);
console.log(`–û–ø–∏—Å–∞–Ω–∏–µ: "${metadata.description}"`);
console.log(`–ö–Ω–∏–≥–∏ –≤ —Å–µ—Ä–∏–∏: ${metadata.books.length}`);

for (const book of metadata.books) {
  console.log(`  - ${book.title} (${book.year})`);
}