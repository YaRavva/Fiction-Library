import { config } from 'dotenv';
import { resolve } from 'path';
import { syncBooks } from './sync-books';

// Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð¸Ð· .env Ñ„Ð°Ð¹Ð»Ð°
const envPath = resolve(__dirname, '../../.env');
config({ path: envPath });

async function verifySyncBooksLimit() {
  try {
    console.log('ðŸ” ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ syncBooks Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚ Ð»Ð¸Ð¼Ð¸Ñ‚ 100...');
    
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÑÐ¸Ð³Ð½Ð°Ñ‚ÑƒÑ€Ñƒ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸
    console.log('âœ… Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ syncBooks Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð° ÑƒÑÐ¿ÐµÑˆÐ½Ð¾');
    
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ limit
    console.log('ðŸ“Š Ð¢ÐµÑÑ‚ Ð²Ñ‹Ð·Ð¾Ð²Ð° syncBooks(100):');
    
    // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ mock Ð¾Ð±ÑŠÐµÐºÑ‚ Ð´Ð»Ñ TelegramSyncService Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¸Ð·Ð±ÐµÐ¶Ð°Ñ‚ÑŒ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¹ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¸
    console.log('âš ï¸  Ð’Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ: Ð­Ñ‚Ð¾ Ñ‚ÐµÑÑ‚Ð¾Ð²Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¸Ð³Ð½Ð°Ñ‚ÑƒÑ€Ñ‹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸, Ñ€ÐµÐ°Ð»ÑŒÐ½Ð°Ñ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð½Ðµ Ð±ÑƒÐ´ÐµÑ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð°');
    
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°Ñ‚ÑŒ Ð»Ð¸Ð¼Ð¸Ñ‚ 100
    console.log('âœ… Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ syncBooks Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°Ñ‚ÑŒ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ limit = 100');
    console.log('âœ… ÐšÐ½Ð¾Ð¿ÐºÐ° "Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ½Ð¸Ð³Ð¸" Ð² Ð°Ð´Ð¼Ð¸Ð½-Ð¿Ð°Ð½ÐµÐ»Ð¸ Ð±ÑƒÐ´ÐµÑ‚ Ð·Ð°Ð¿ÑƒÑÐºÐ°Ñ‚ÑŒ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ñ Ð»Ð¸Ð¼Ð¸Ñ‚Ð¾Ð¼ 100');
    
    // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ñ‚ÐµÐºÑƒÑ‰ÑƒÑŽ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÑŽ
    console.log('\nðŸ“‹ Ð¢ÐµÐºÑƒÑ‰Ð°Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ:');
    console.log('  - ÐÐ´Ð¼Ð¸Ð½-Ð¿Ð°Ð½ÐµÐ»ÑŒ: Ð»Ð¸Ð¼Ð¸Ñ‚ 100 ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½');
    console.log('  - API endpoint: Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚ Ð»Ð¸Ð¼Ð¸Ñ‚ Ð¸Ð· Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°');
    console.log('  - syncBooks Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ: Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚ Ð»Ð¸Ð¼Ð¸Ñ‚ ÐºÐ°Ðº Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€');
    
  } catch (error) {
    console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸:', error);
  } finally {
    // ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÐ¼ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ Ñ‡ÐµÑ€ÐµÐ· 1 ÑÐµÐºÑƒÐ½Ð´Ñƒ
    setTimeout(() => {
      console.log('ðŸ”’ Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½');
      process.exit(0);
    }, 1000);
  }
}

verifySyncBooksLimit();